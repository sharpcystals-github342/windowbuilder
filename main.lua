if not game then return nil end;local cloneref=cloneref or function(a)return a end;local b=cloneref(game)local function c(d)return cloneref(b:GetService(d))end;local e=cloneref(c("Players").LocalPlayer)local f=c("CoreGui")local g=cloneref(e:GetMouse())if not getgenv then f=cloneref(e:FindFirstChild("PlayerGui"))getgenv=function()return _G end end;local h=getgenv()h.windowsopened_ppxsystem=h.windowsopened_ppxsystem or{}h.focusedProcessID=h.focusedProcessID or nil;local i=Color3.fromRGB(88,101,242)local j=Color3.fromRGB(235,69,69)local function k(l)return typeof(l)=="UDim2"end;local function m(l)return type(l)=="string"end;local function n(l)return type(l)=="number"end;local function o(l,p)return typeof(l)=="Instance"and l:IsA(p)end;local q={}q.__index=q;function q.new()local self=setmetatable({},q)self._connections={}return self end;function q:Connect(r)if type(r)=="function"then local s={func=r,connected=true}table.insert(self._connections,s)return{Disconnect=function()s.connected=false;for t,u in ipairs(self._connections)do if u==s then table.remove(self._connections,t)break end end end}end end;function q:Fire(...)for v,s in ipairs(self._connections)do if s.connected then s.func(...)end end end;local w={}w.__index=w;function w.new(x,y,z)assert(k(x),"Invalid position")assert(k(y),"Invalid size")assert(m(z),"Invalid title")local self=setmetatable({},w)self.windowPosition=x;self.windowSize=y;self.title=z;self.processID=#h.windowsopened_ppxsystem+1;self.UI=nil;self.MainFrame=nil;self.windowClosed=q.new()self.windowMinimising=q.new()self.minimized=false;self.minimizedButton=nil;self.storedContents=nil;return self end;function w:__newindex(A,l)if A=="title"and m(l)then rawset(self,A,l)if self.MainFrame then local B=self.MainFrame:FindFirstChild("TitleBar")if B and o(B,"TextLabel")then B.Text=l end end elseif A=="windowSize"and k(l)then rawset(self,A,l)if self.MainFrame then self.MainFrame.Size=l end elseif A=="windowPosition"and k(l)then rawset(self,A,l)if self.MainFrame then self.MainFrame.Position=l end elseif A=="processID"and n(l)then rawset(self,A,l)if self.UI then self.UI.Name=tostring(l)end else rawset(self,A,l)end end;function w:closeWindow()self.windowClosed:Fire()local C=c("TweenService")local D=TweenInfo.new(0.3,Enum.EasingStyle.Quart,Enum.EasingDirection.Out)if self.MainFrame then local E=C:Create(self.MainFrame,D,{Transparency=1})E:Play()for v,F in ipairs(self.MainFrame:GetDescendants())do if o(F,"GuiObject")then C:Create(F,D,{Transparency=1}):Play()end end;E.Completed:Connect(function()for t,G in ipairs(h.windowsopened_ppxsystem)do if G==self then table.remove(h.windowsopened_ppxsystem,t)break end end;if self.UI then self.UI:Destroy()end end)end end;function w:minimizeWindow()if self.minimized then return end;self.windowMinimising:Fire()self.minimized=true;if self.MainFrame then self.storedContents=self.MainFrame:Clone()local H=Instance.new("Frame")H.Size=UDim2.new(0,36,0,36)H.Position=self.MainFrame.Position;H.BackgroundColor3=Color3.new(0,0,0)H.BackgroundTransparency=0.5;H.BorderSizePixel=0;H.Parent=self.UI;local I=Instance.new("UICorner")I.CornerRadius=UDim.new(1,0)I.Parent=H;local J=Instance.new("ImageButton")J.Size=UDim2.new(1,-8,1,-8)J.Position=UDim2.new(0,4,0,4)J.Image="rbxassetid://3926307971"J.ImageRectOffset=Vector2.new(324,364)J.ImageRectSize=Vector2.new(36,36)J.ImageColor3=Color3.new(1,1,1)J.BackgroundTransparency=1;J.Parent=H;local C=c("TweenService")local D=TweenInfo.new(0.3,Enum.EasingStyle.Quart,Enum.EasingDirection.Out)C:Create(H,D,{BackgroundTransparency=0.5}):Play()C:Create(J,D,{ImageTransparency=0}):Play()self.MainFrame:Destroy()self.MainFrame=nil;self.minimizedButton=H;local K;local L;local M;local N;local function O(P)local Q=P.Position-M;H.Position=UDim2.new(N.X.Scale,N.X.Offset+Q.X,N.Y.Scale,N.Y.Offset+Q.Y)end;J.InputBegan:Connect(function(P)if P.UserInputType==Enum.UserInputType.MouseButton1 or P.UserInputType==Enum.UserInputType.Touch then K=true;M=P.Position;N=H.Position;P.Changed:Connect(function()if P.UserInputState==Enum.UserInputState.End then K=false end end)end end)J.InputChanged:Connect(function(P)if P.UserInputType==Enum.UserInputType.MouseMovement or P.UserInputType==Enum.UserInputType.Touch then L=P end end)c("UserInputService").InputChanged:Connect(function(P)if P==L and K then O(P)end end)H.MouseEnter:Connect(function()C:Create(H,TweenInfo.new(0.2),{BackgroundColor3=i}):Play()end)H.MouseLeave:Connect(function()C:Create(H,TweenInfo.new(0.2),{BackgroundColor3=Color3.new(0,0,0)}):Play()end)J.MouseButton1Click:Connect(function()self:maximizeWindow()end)end end;function w:maximizeWindow()if not self.minimized then return end;self.minimized=false;if self.storedContents then local R=self.storedContents:Clone()R.Parent=self.UI;self.MainFrame=R;local C=c("TweenService")local D=TweenInfo.new(0.3,Enum.EasingStyle.Quart,Enum.EasingDirection.Out)self.MainFrame.Transparency=1;for v,F in ipairs(self.MainFrame:GetDescendants())do if o(F,"GuiObject")then F.Transparency=1 end end;C:Create(self.MainFrame,D,{Transparency=0}):Play()for v,F in ipairs(self.MainFrame:GetDescendants())do if o(F,"GuiObject")then C:Create(F,D,{Transparency=0}):Play()end end;if self.minimizedButton then self.minimizedButton:Destroy()self.minimizedButton=nil end;self.storedContents=nil;self:implementFunctionality()end end;function w:implementFunctionality()if not self.MainFrame then return end;local S=self.MainFrame;local B=S:FindFirstChild("TitleBar")local T=S:FindFirstChild("CloseButton")local U=S:FindFirstChild("MinimizeButton")if not(B and T and U)then return end;local K;local L;local M;local N;local function O(P)local Q=P.Position-M;S.Position=UDim2.new(N.X.Scale,N.X.Offset+Q.X,N.Y.Scale,N.Y.Offset+Q.Y)end;B.InputBegan:Connect(function(P)if P.UserInputType==Enum.UserInputType.MouseButton1 or P.UserInputType==Enum.UserInputType.Touch then K=true;M=P.Position;N=S.Position;P.Changed:Connect(function()if P.UserInputState==Enum.UserInputState.End then K=false end end)end end)B.InputChanged:Connect(function(P)if P.UserInputType==Enum.UserInputType.MouseMovement or P.UserInputType==Enum.UserInputType.Touch then L=P end end)c("UserInputService").InputChanged:Connect(function(P)if P==L and K then O(P)end end)local function V(W,X)W.MouseEnter:Connect(function()c("TweenService"):Create(W,TweenInfo.new(0.2),{BackgroundColor3=X}):Play()end)W.MouseLeave:Connect(function()c("TweenService"):Create(W,TweenInfo.new(0.2),{BackgroundColor3=Color3.new(1,1,1)}):Play()end)end;V(T,j)V(U,Color3.new(0.8,0.8,0.8))T.MouseButton1Click:Connect(function()self:closeWindow()end)U.MouseButton1Click:Connect(function()self:minimizeWindow()end)local function Y(Z,_)local a0=20;local a1=Z.AbsoluteSize;local a2=Z.AbsolutePosition;local a3=(_-a2).Magnitude<a0;local a4=(_-(a2+Vector2.new(a1.X,0))).Magnitude<a0;local a5=(_-(a2+Vector2.new(0,a1.Y))).Magnitude<a0;local a6=(_-(a2+a1)).Magnitude<a0;return a3,a4,a5,a6 end;local a7=false;local a8;local a9;local aa;S.InputBegan:Connect(function(P)if P.UserInputType==Enum.UserInputType.MouseButton1 then local ab=Vector2.new(P.Position.X,P.Position.Y)local a3,a4,a5,a6=Y(S,ab)if a3 or a4 or a5 or a6 then a7=true;a8={topLeft=a3,topRight=a4,bottomLeft=a5,bottomRight=a6}a9=S.Size;aa=ab end end end)S.InputChanged:Connect(function(P)if P.UserInputType==Enum.UserInputType.MouseMovement then local ab=Vector2.new(P.Position.X,P.Position.Y)local a3,a4,a5,a6=Y(S,ab)if a3 or a4 or a5 or a6 then g.Icon="rbxassetid://928721675"else g.Icon=""end end end)c("UserInputService").InputChanged:Connect(function(P)if a7 and P.UserInputType==Enum.UserInputType.MouseMovement then local ab=Vector2.new(P.Position.X,P.Position.Y)local Q=ab-aa;local ac=a9;if a8.bottomRight then ac=UDim2.new(a9.X.Scale,a9.X.Offset+Q.X,a9.Y.Scale,a9.Y.Offset+Q.Y)elseif a8.topLeft then ac=UDim2.new(a9.X.Scale,a9.X.Offset-Q.X,a9.Y.Scale,a9.Y.Offset-Q.Y)S.Position=UDim2.new(S.Position.X.Scale,S.Position.X.Offset+Q.X,S.Position.Y.Scale,S.Position.Y.Offset+Q.Y)elseif a8.topRight then ac=UDim2.new(a9.X.Scale,a9.X.Offset+Q.X,a9.Y.Scale,a9.Y.Offset-Q.Y)S.Position=UDim2.new(S.Position.X.Scale,S.Position.X.Offset,S.Position.Y.Scale,S.Position.Y.Offset+Q.Y)elseif a8.bottomLeft then ac=UDim2.new(a9.X.Scale,a9.X.Offset-Q.X,a9.Y.Scale,a9.Y.Offset+Q.Y)S.Position=UDim2.new(S.Position.X.Scale,S.Position.X.Offset+Q.X,S.Position.Y.Scale,S.Position.Y.Offset)end;S.Size=ac end end)c("UserInputService").InputEnded:Connect(function(P)if P.UserInputType==Enum.UserInputType.MouseButton1 then a7=false;a8=nil;a9=nil;aa=nil;g.Icon=""end end)end;local ad={}function ad.createWindow(x,y,z)assert(k(x),"Invalid position")assert(k(y),"Invalid size")assert(m(z),"Invalid title")local G=w.new(x,y,z)local ae=Instance.new("ScreenGui")ae.Name=tostring(G.processID)ae.DisplayOrder=7;ae.IgnoreGuiInset=true;ae.Parent=f;G.UI=ae;local S=Instance.new("Frame")S.Name="MainFrame"S.Size=G.windowSize;S.Position=G.windowPosition;S.BackgroundColor3=Color3.new(1,1,1)S.BorderSizePixel=0;S.Parent=ae;G.MainFrame=S;local af=20;if c("UserInputService").TouchEnabled then af=30 end;local B=Instance.new("TextLabel")B.Name="TitleBar"B.Size=UDim2.new(1,-60,0,af)B.Position=UDim2.new(0,0,0,0)B.Text=G.title;B.TextColor3=Color3.new(0,0,0)B.TextXAlignment=Enum.TextXAlignment.Left;B.TextYAlignment=Enum.TextYAlignment.Center;B.Font=Enum.Font.BuilderSans;B.TextSize=14;B.BackgroundColor3=Color3.new(1,1,1)B.BorderSizePixel=0;B.Parent=S;local ag=Instance.new("Frame")ag.Name="Contents"ag.Size=UDim2.new(1,0,1,-af)ag.Position=UDim2.new(0,0,0,af)ag.BackgroundColor3=Color3.new(1,1,1)ag.BorderSizePixel=0;ag.Parent=S;local T=Instance.new("ImageButton")T.Name="CloseButton"T.Size=UDim2.new(0,af,0,af)T.Position=UDim2.new(1,-af,0,0)T.Image="http://www.roblox.com/asset/?id=6031094678"T.ImageColor3=Color3.new(0,0,0)T.BackgroundColor3=Color3.new(1,1,1)T.BorderSizePixel=0;T.AutoButtonColor=false;T.Parent=S;local U=Instance.new("ImageButton")U.Name="MinimizeButton"U.Size=UDim2.new(0,af,0,af)U.Position=UDim2.new(1,-af*2,0,0)U.Image="http://www.roblox.com/asset/?id=6026568240"U.ImageColor3=Color3.new(0,0,0)U.BackgroundColor3=Color3.new(1,1,1)U.BorderSizePixel=0;U.AutoButtonColor=false;U.Parent=S;G:implementFunctionality()local function ah()for v,ai in ipairs(h.windowsopened_ppxsystem)do if ai.processID==h.focusedProcessID then if ai.MainFrame then ai.MainFrame.BorderSizePixel=0;ai.MainFrame.BorderColor3=i end;if ai.UI then ai.UI.DisplayOrder=8 end else if ai.MainFrame then ai.MainFrame.BorderSizePixel=0 end;if ai.UI then ai.UI.DisplayOrder=7 end end end end;local aj=c("UserInputService")aj.InputBegan:Connect(function(P)if P.UserInputType==Enum.UserInputType.MouseButton1 or P.UserInputType==Enum.UserInputType.Touch then local _=P.Position;if S.AbsolutePosition.X<=_.X and _.X<=S.AbsolutePosition.X+S.AbsoluteSize.X and S.AbsolutePosition.Y<=_.Y and _.Y<=S.AbsolutePosition.Y+S.AbsoluteSize.Y then h.focusedProcessID=G.processID;ah()end end end)S.Transparency=1;for v,F in ipairs(S:GetDescendants())do if o(F,"GuiObject")then F.Transparency=1 end end;local C=c("TweenService")local D=TweenInfo.new(0.3,Enum.EasingStyle.Quart,Enum.EasingDirection.Out)C:Create(S,D,{Transparency=0}):Play()for v,F in ipairs(S:GetDescendants())do if o(F,"GuiObject")then C:Create(F,D,{Transparency=0}):Play()end end;table.insert(h.windowsopened_ppxsystem,G)h.focusedProcessID=G.processID;ah()return G end;return ad
